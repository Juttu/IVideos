<!doctype html>
<html>
<head>
   <title>Video.js Markers Example</title>


   <link href="http://vjs.zencdn.net/4.3/video-js.css" rel="stylesheet">
   <link href="../dist/videojs.markers.css" rel="stylesheet">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
   <link rel="stylesheet" href="styles.css">
   <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
   <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">

</head>
<body>

  <p id="smile" style="display: none;">0</p>
  <h id="sm" style="display: none;" >&#129409; : <h id="count">0</h></h>
  <p style="width: 20px;display: none;"><span id='display'></span></p>
  <IMG SRC="sm.gif" style="width:30px;height:30px;">

   <!-- <input type="checkbox" id="r4"><label for="r4" class="react"  style="--r:15px"><i data-icon="👍"></i></label> -->


  <div class="videoContainer">

   <video id="test_video" muted controls preload="none" preferFullWindow="true" class="video-js vjs-default-skin" width="720" height="350" >
      <!-- <source src="http://vjs.zencdn.net/v/oceans.mp4" type="video/mp4">
      <source src="http://vjs.zencdn.net/v/oceans.webm" type="video/webm"> -->
      <source src="3min.mp4" type="video/mp4">

   </video>
  <div class="moveToVideoJs">
   <div class="advertisement">
      <!-- <button class="advertisement" onclick="openForm()">Comment </button> -->

        <div class="form-popup" id="myForm">
           <div class="form-container">
              <h1>Comment</h1>
           
              <!-- <label for="email"><b>Email</b></label> -->
              <input type="text" id="user_input" placeholder="Comment"required>

           
              
           
              <button class="btn" onclick="submit()" >Submit</button>
              <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
           </div>
        </div>
     </div>
 </div>

</div>

<!-- <label>Your input: </label> -->






 
 <ul style="margin-left: 65%; margin-top: -30%;width: 100px;" id='marker-list'>Reactions :
  
 </ul>


<ul style="margin-left: 65%; margin-top: 50px;"id='marker-list1'>Comments : 
  

</ul>


 <!-- <div class='event-list'>
  <div><b>Events: </b></div>
</div> -->
<!-- <div class='add'>Add</div> -->
<ul id='list' style="color: red;">
  <!-- <li> 😆: 50</li>
  <li>ok</li>
  <li>good</li> -->
  
</ul>
<ul style="margin-left: 0%; margin-top: 25%;width: 390px;" id='marker-list'>
  
<div >
   <body>
      <div class="container">
         <div class="col-md-12" id="fbcomment">
            <div class="header_comment">
               <div class="row">
                  <!-- <div class="col-md-6 text-left">
                    <span class="count_comment">264235 Comments</span>
                  </div> -->
                  <div class="col-md-6 text-right">
                    <!-- <span class="sort_title">Sort by</span>
                    <select class="sort_by">
                     <option>Top</option>
                     <option>Newest</option>
                     <option>Oldest</option> -->
                    </select>
                  </div>
               </div>
            </div>
   
            <div class="body_comment">
               <div class="row">
                  <div class="avatar_comment col-md-1">
                    <img src="https://static.xx.fbcdn.net/rsrc.php/v1/yi/r/odA9sNLrE86.jpg" alt="avatar"/>
                  </div>
                  <div class="box_comment col-md-11">
                    <textarea class="commentar" placeholder="Add a comment..."></textarea>
                    <div class="box_post">
                     <!-- <div class="pull-left">
                       <input type="checkbox" id="post_fb"/>
                       <label for="post_fb">Also post on Facebook</label>
                     </div> -->
                     <div class="pull-right">
                       <!-- <span>
                        <img src="https://static.xx.fbcdn.net/rsrc.php/v1/yi/r/odA9sNLrE86.jpg" alt="avatar" />
                        <i class="fa fa-caret-down"></i>
                       </span> -->
                       <button onclick="submit_comment()" type="button" value="1">Post</button>
                     </div>
                    </div>
                  </div>
               </div>
               <div class="row">
                  <ul id="list_comment" class="col-md-12">
                     <!-- Start List Comment 1 -->
                     
                     
                     <!-- Start List Comment 2 -->
                     
                  </ul>
               <!-- <button class="show_more" type="button">Load 10 more comments</button> -->
               </div>
            </div>
         </div>
      </div>
   </body>

   
</div>
</ul>


  

</body>
<script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
<script src="http://vjs.zencdn.net/4.3/video.js"></script>
<script src='../dist/videojs-markers.js'></script>

<script>
   // initialize video.js
   var player = videojs('test_video');


   var emote=[];
   var comment=[];
   var timearray=[];


   document.getElementById("test_video").addEventListener("loadedmetadata", function() {
      // this.currentTime = 10;
      console.log("okk")
   });
   // document.getElementsByClassName("vjs-marker")[0].style.color = "blue";


   function onloadfun() {
            var time=1552;
         var time_count=time/20;
         two_sec=2
         console.log(time_count)

         for (let i = 0; i < time_count; i++) {
            markers.push({time: two_sec,
                        text: "Chapter"+two_sec})
            two_sec=two_sec+20
         }
      }

   //load the marker plugin

   var markers = [
         // {
         //    time: 9.5,
         //    text: "Hello"
         // }
      ];

   //load the marker plugin
   player.markers({
      markerTip:{
         display: true,
         text: function(marker){
            return marker.text;
         }
      },
      breakOverlay:{
         display: true,
         displayTime: 2,
         text: function(marker) {
            return "Break overlay: " +"\n\n\n"+ marker.text;
         }
      },
      onMarkerReached: function(marker) {
        console.log(marker);
      },
      markers: markers
   });

   var smile=0;
            var smile1=0;
            var smile2=0;
            var smile3=0;
            var j=0;
            var cnt=0;
            var open=0;
            var c=0;



//emote1
            var myButton = player.controlBar.addChild("button");
            var myButtonDom = myButton.el();
            // myButtonDom.innerHTML = '<button class="b1" <span style="font-size:25px;"">&#128512; </span></button>';
            // myButtonDom.innerHTML = '<IMG SRC="sm1.gif" style="width:30px;height:30px;">';
            myButtonDom.innerHTML = '<input type="checkbox" id="r4"><label for="r4" class="react"  style="--r:40px"><i data-icon="👍"></i></label>';



            myButtonDom.style.cssText = 'font-size: 18px;';


                        // $(document).ready(function(){

            myButtonDom.onclick = function(){
            
               document.getElementById("smile").innerHTML = smile;
               var currtime=player.currentTime();
            // console.log(markers[0].time)
               
                                 smile++;
                     
                  l=document.getElementById("list").innerText
                  // console.log(l)
                  // player.markers.add([{
                  //       time: 95,
                  //       text: "😀 : " + smile + "😀 : " + smile
                  //    }]);
                    

                  console.log(emote.length)
                  // emote.push({time:player.currentTime(),text :"😆"+player.currentTime()})
                  // cnt++;
                  console.log(emote)
                  var currenttime1=player.currentTime();
                     
                     // var item1 = $("<li data-index='"+j+"'><a href='#'>"+emote[j].text+"</a></li>");
                     // j++;
                     // $("#marker-list").append(item1);


         
                  
                  // if(currtime>markers[0].time && currtime <markers[1].time )
                  // {
                  //       // console.log("ok")
                  //                smile1++;
                  //                player.markers.add([{
                  //                      time: markers[1].time,
                  //                      text: "😀 : "+ smile1 + "😀 : " + smile1,
                                       
                  //                   }]);
                  //                   // emote.push({time:player.currentTime(),text :"😆"+player.currentTime()})
                  //                   // cnt++;
         
                  // }
                  markers.push({time:player.currentTime(),text :"😀"+player.currentTime()})
                  emote.push({time:player.currentTime(),text :"😀"+format(Math.trunc(player.currentTime()))})

                                    cnt++;
                  console.log('Marker',markers)
                  start(cnt);

                
            } 
          

            var myButton1 = player.controlBar.addChild("button");
            var myButtonDom1 = myButton1.el();
            myButtonDom1.innerHTML = '<IMG class="b1" SRC="doubt1.gif" style="width:30px;height:30px;">';
            myButtonDom1.style.cssText = 'font-size: 18px;';

            myButtonDom1.onclick = function(){
            
               var t=player.currentTime();
               t=Math.trunc(t)
               console.log(t)


               if(t%2!=0)
               {
                  timearray.push({time:t+1,text :smile1})
                  index=timearray.findIndex((obj=>obj.time==t+1))
                  let counter=0
                  for(let i=0;i<timearray.length;i++)
                  {
                     if(timearray[i].time==t+1)counter++;
                  }
                  console.log('counter',counter)

                  console.log("index",index)
                  console.log("count",timearray)


                  player.markers.add([{
                        time: t+1,
                        text: "😕 : " + counter +  " " + "👍 : " + 1 +" "+"🤔 :" + 2
                     }]);

               }


               else{

                  timearray.push({time:t+2,text :smile1})
                  index=timearray.findIndex((obj=>obj.time==t+2))
                  let counter=0
                  for(let i=0;i<timearray.length;i++)
                  {
                     if(timearray[i].time==t+2)counter++;
                  }
                  console.log('counter',counter)

                  console.log("index",index)
                  console.log("count",timearray)

                  player.markers.add([{
                        time: t+2,
                        text: "😕 : " + counter + " " + "👍 : " + 1 +" " +"🤔 :" + 2
                     }]);
               }
               
              


                
            } 


            var myButton3 = player.controlBar.addChild("button");
            var myButtonDom3 = myButton3.el();
            myButtonDom3.innerHTML = '<button class="b1" <span style="font-size:25px;"">&#128077; </span></button>';
            myButtonDom3.style.cssText = 'font-size: 18px;';
            myButtonDom3.onclick = function(){



               console.log("hello")
            
               openForm();

             
            } 


            var myButton4 = player.controlBar.addChild("button");
            var myButtonDom4 = myButton4.el();
            myButtonDom4.innerHTML = '<button class="b1" <span style="font-size:25px;"">&#129300; </span></button>';
            myButtonDom4.style.cssText = 'font-size: 18px;';
            myButtonDom4.onclick = function(){



               console.log("hello")
            
               openForm();

             
            }







            var myButton2 = player.controlBar.addChild("button");
            var myButtonDom2 = myButton2.el();
            myButtonDom2.innerHTML = '<span class="material-icons">question_answer</span>';
            myButtonDom2.style.cssText = 'font-size: 30px;';
            myButtonDom2.onclick = function(){



               console.log("hello")
            
               openForm();

             
            } 




            function start(s)
            {
               $(document).ready(function(){
               // insert marker list
               // for(var i =s-1; i < emote.length; i++){
                  var item = $("<li data-index='"+s+"'><a href='#'>"+emote[s-1].text+"</a></li>");
                  $("#marker-list").append(item);
               // }

               // set up click event
               $("#marker-list li").click(function(){
                  var index = $(this).data("index");
                  console.log(index)

                  player.currentTime(emote[index-1].time);
               });

            });
      }

      $(document).ready(function(){
    
  $(".moveToVideoJs").appendTo($('#test_video'));
		// show advertisement label while play advertisement
		
		// Stop from seeking while playing advertisement
		
		
		// Hide Advertisement label and change data-src of player to play actual video
		
});

function openForm() {

   if (open==0){
      document.getElementById("myForm").style.display = "block";
      open=1

   }
   else
   {
      document.getElementById("myForm").style.display = "none";
      open=0

   }


}

function closeForm() {

   open=0
  document.getElementById("myForm").style.display = "none";

}

function submit()
{
   open=0
   var cmt=document.getElementById("user_input").value;
   console.log(cmt)
   document.getElementById('display').innerHTML = document.getElementById("user_input").value;

   comment.push({time:player.currentTime(),text :cmt+" "+"@"+" "+ format(Math.trunc(player.currentTime()))})
   console.log(comment[0].text)

   $(document).ready(function(){
         // insert marker list
               // for(var i =s-1; i < emote.length; i++){
                  console.log("okok")
                  var item1 = $("<div class=\"tooltip\"><li data-commentindex='"+c+"'><a href='#'>"+comment[c].text+"</a></li><span class=\"tooltiptext\">Clicking this makes you go to the timestamp </span></div>");
                  $("#marker-list1").append(item1);
               // }
//                <div class="tooltip"><li data-commentindex='"+c+"'><a href='#'>"+comment[c].text+"</a></li>
//    <span class="tooltiptext">Tooltip text</span>
//  </div>
               // set up click event
               $("#marker-list1 li").click(function(){
                  var index1 = $(this).data("commentindex");
                  console.log(index1)

                  player.currentTime(comment[index1].time);
               });
               c++;

            });



   document.getElementById("myForm").style.display = "none";

    
}

      

   $(document).ready(function(){
      // insert marker list
      for(var i =0; i < markers.length; i++){
         var item = $("<li data-index='"+i+"'><a href='#'>"+markers[i].text+"</a></li>");
         $("#marker-list").append(item);
      }

      // set up click event
      $("#marker-list li").click(function(){
         var index = $(this).data("index");

         player.currentTime(markers[index].time);
      });

   });
   function format(time) {   
    // Hours, minutes and seconds
    var hrs = ~~(time / 3600);
    var mins = ~~((time % 3600) / 60);
    var secs = ~~time % 60;

    // Output like "1:01" or "4:03:59" or "123:03:59"
    var ret = "";
    if (hrs > 0) {
        ret += "" + hrs + ":" + (mins < 10 ? "0" : "");
    }
    ret += "" + mins + ":" + (secs < 10 ? "0" : "");
    ret += "" + secs;
    return ret;
}

//Facebook Comments Js

         

         

</script>

<script src="../jsfiles/fbcomments.js"></script>

</html>
