<!doctype html>
<html>
<head>
   <title>Video.js Markers Example</title>

   <style>
         p {
         border: thin solid #777;
         padding: 10px;
      }
      ul#marker-list,ul#marker-list1{
         list-style-type: none;
         margin: 0;
         padding: 0;
         width: 300px;
         margin-top: 10px;
      }
      
      ul#marker-list,ul#marker-list1 li{
         position: relative;
         margin-bottom: -1px;
         background-color: #fff;
         border: 1px solid #ddd;       
      }
      ul#marker-list,ul#marker-list1 li:last-child {
         margin-bottom: 0;
         border-bottom-right-radius: 4px;
         border-bottom-left-radius: 4px;
      }
      ul#marker-list,ul#marker-list1 li a{
         display: block;
         padding: 10px 15px;
         color: #555;
         text-decoration: none;
      }
      ul#marker-list,ul#marker-list1 li a:hover {
         color: #555;
         text-decoration: none;
         background-color: #f5f5f5;
      }
      .vjs-tip-inner{
         height: 80px;
         width: 35px;
         color: rgb(225, 110, 65);
      }
      .blue-marker-class{
         background-color: #4949d8 !important;
            }


/* 
               .vjs-break-overlay { 
                  animation: hideAnimation 0s ease-in 5s;
                  animation-fill-mode: forwards;
               }

               @keyframes hideAnimation {
  to {
    visibility: hidden;
    width: 0;
    height: 0;
  }
} */










                 /* /* /* video container */
.videoContainer {
  margin: 20px auto 0;
}
.advertisement{
	position:absolute;
  	color: rgb(230, 200, 98);
  	padding: 5px 10px;
  	text-align: right;
  	background: rgba(0, 0, 0, 0.4);
    bottom: 50px;
  	right:0;
  	font-size: 14px;
  	font-weight: 700;
  	z-index: 1 !important;
}
.hide{
  display:none;
}



.open-button {
  background-color: rgb(214, 16, 16);
  color: white;
  padding: 16px 20px;
  border: none;
  cursor: pointer;
  opacity: 0.8;
  position: fixed;
  bottom: 23px;
  right: 28px;
  width: 280px;
  margin-right:100px;
}

/* The popup form - hidden by default */
.form-popup {

  display: none;
  position: fixed;
  bottom: 0;
  right: 15px;
  border: 2px solid #525050;
  z-index: 9;
  margin-right:50%;
  margin-bottom:410px;


}

/* Add styles to the form container */
.form-container {
  max-width: 300px;
  padding: 10px;
  background-color: white;
}
.form-container input[type=text], .form-container input[type=password] {
  width: 80%;
  padding: 15px;
  margin: 5px 0 22px 0;
  border: 1px solid #bbb8b8;
  background: #f1f1f1f1;
}

/* When the inputs get focus, do something */


/* Set a style for the submit/login button */
.form-container .btn {
  background-color: #63d447;
  color: white;
  padding: 16px 20px;
  border: none;
  cursor: pointer;
  width: 50%;
  margin-bottom:10px;
  margin-left:10px;

  opacity: 0.8;
}

/* Add a red background color to the cancel button */
.form-container .cancel {
  background-color: rgb(248, 98, 98);


}

/* Add some hover effects to buttons */
.form-container .btn:hover, .open-button:hover {
  opacity: 1;
}
/* #bt{
  font-size: 20px;
  height: 0px;
  width: 0px;
  background-color: rgba(0,0,0,.5);
  margin-top: 20%;

} */


/* Facebook Comment Style */
body{
  margin:20px;
  font-family: Helvetica, Arial, sans-serif;
}
.pull-right{
  float:right;
}
.pull-left{
  float:left;
}
#fbcomment{
  background:#fff;
  border: 1px solid #dddfe2;
  border-radius: 3px;
  color: #4b4f56;
  padding:50px;
}
.header_comment{
    font-size: 14px;
    overflow: hidden;
    border-bottom: 1px solid #e9ebee;
    line-height: 25px;
    margin-bottom: 24px;
    padding: 10px 0;
}
.sort_title{
  color: #4b4f56;
}
.sort_by{
  background-color: #f5f6f7;
  color: #4b4f56;
  line-height: 22px;
  cursor: pointer;
  vertical-align: top;
  font-size: 12px;
  font-weight: bold;
  vertical-align: middle;
  padding: 4px;
  justify-content: center;
  border-radius: 2px;
  border: 1px solid #ccd0d5;
}
.count_comment{
  font-weight: 600;
}
.body_comment{
    padding: 0 8px;
    font-size: 14px;
    display: block;
    line-height: 25px;
    word-break: break-word;
}
.avatar_comment{
  display: block;
}
.avatar_comment img{
  height: 48px;
  width: 48px;
}
.box_comment{
	display: block;
    position: relative;
    line-height: 1.358;
    word-break: break-word;
    border: 1px solid #d3d6db;
    word-wrap: break-word;
    background: #fff;
    box-sizing: border-box;
    cursor: text;
    font-family: Helvetica, Arial, sans-serif;
    font-size: 16px;
	padding: 0;
}
.box_comment textarea{
	min-height: 40px;
	padding: 12px 8px;
	width: 100%;
	border: none;
	resize: none;
}
.box_comment textarea:focus{
  outline: none !important;
}
.box_comment .box_post{
	border-top: 1px solid #d3d6db;
    background: #f5f6f7;
    padding: 8px;
    display: block;
    overflow: hidden;
}
.box_comment label{
  display: inline-block;
  vertical-align: middle;
  font-size: 11px;
  color: #90949c;
  line-height: 22px;
}
.box_comment button{
  margin-left:8px;
  background-color: #4267b2;
  border: 1px solid #4267b2;
  color: #fff;
  text-decoration: none;
  line-height: 22px;
  border-radius: 2px;
  font-size: 14px;
  font-weight: bold;
  position: relative;
  text-align: center;
}
.box_comment button:hover{
  background-color: #29487d;
  border-color: #29487d;
}
.box_comment .cancel{
	margin-left:8px;
	background-color: #f5f6f7;
	color: #4b4f56;
	text-decoration: none;
	line-height: 22px;
	border-radius: 2px;
	font-size: 14px;
	font-weight: bold;
	position: relative;
	text-align: center;
  border-color: #ccd0d5;
}
.box_comment .cancel:hover{
	background-color: #d0d0d0;
	border-color: #ccd0d5;
}
.box_comment img{
  height:16px;
  width:16px;
}
.box_result{
  margin-top: 24px;
}
.box_result .result_comment h4{
  font-weight: 600;
  white-space: nowrap;
  color: #365899;
  cursor: pointer;
  text-decoration: none;
  font-size: 14px;
  line-height: 1.358;
  margin:0;
}
.box_result .result_comment{
  display:block;
  overflow:hidden;
  padding: 0;
}
.child_replay{
	border-left: 1px dotted #d3d6db;
	margin-top: 12px;
	list-style: none;
	padding:0 0 0 8px
}
.reply_comment{
	margin:12px 0;
}
.box_result .result_comment p{
  margin: 4px 0;
  text-align:justify;
}
.box_result .result_comment .tools_comment{
  font-size: 12px;
  line-height: 1.358;
}
.box_result .result_comment .tools_comment a{
  color: #4267b2;
  cursor: pointer;
  text-decoration: none;
}
.box_result .result_comment .tools_comment span{
  color: #90949c;
}
.body_comment .show_more{
  background: #3578e5;
  border: none;
  box-sizing: border-box;
  color: #fff;
  font-size: 14px;
  margin-top: 24px;
  padding: 12px;
  text-shadow: none;
  width: 100%;
  font-weight:bold;
  position: relative;
  text-align: center;
  vertical-align: middle;
  border-radius: 2px;
}

   </style>
   <link href="http://vjs.zencdn.net/4.3/video-js.css" rel="stylesheet">
   <link href="../dist/videojs.markers.css" rel="stylesheet">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

</head>
<body>

  <p id="smile" style="display: none;">0</p>
  <h id="sm" style="display: none;" >&#129409; : <h id="count">0</h></h>
  <p style="width: 20px;display: none;"><span id='display'></span></p>

  <div class="videoContainer">

   <video id="test_video" muted controls preload="none" preferFullWindow="true" class="video-js vjs-default-skin" width="720" height="350" >
      <!-- <source src="http://vjs.zencdn.net/v/oceans.mp4" type="video/mp4">
      <source src="http://vjs.zencdn.net/v/oceans.webm" type="video/webm"> -->
      <source src="3min.mp4" type="video/mp4">

   </video>
  <div class="moveToVideoJs">
   <div class="advertisement">
      <!-- <button class="advertisement" onclick="openForm()">Comment </button> -->

        <div class="form-popup" id="myForm">
           <div class="form-container">
              <h1>Comment</h1>
           
              <!-- <label for="email"><b>Email</b></label> -->
              <input type="text" id="user_input" placeholder="Comment"required>
           
              
           
              <button class="btn" onclick="submit()" >Submit</button>
              <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
           </div>
        </div>
     </div>
 </div>

</div>

<!-- <label>Your input: </label> -->






 
 <ul style="margin-left: 65%; margin-top: -30%;width: 100px;" id='marker-list'>Reactions :
  
 </ul>


<ul style="margin-left: 65%; margin-top: 50px;"id='marker-list1'>Comments : 
  

</ul>


 <!-- <div class='event-list'>
  <div><b>Events: </b></div>
</div> -->
<!-- <div class='add'>Add</div> -->
<ul id='list' style="color: red;">
  <!-- <li> 😆: 50</li>
  <li>ok</li>
  <li>good</li> -->
  
</ul>
<ul style="margin-left: 0%; margin-top: 25%;width: 390px;" id='marker-list'>
  
<div >
   <body>
      <div class="container">
         <div class="col-md-12" id="fbcomment">
            <div class="header_comment">
               <div class="row">
                  <!-- <div class="col-md-6 text-left">
                    <span class="count_comment">264235 Comments</span>
                  </div> -->
                  <div class="col-md-6 text-right">
                    <!-- <span class="sort_title">Sort by</span>
                    <select class="sort_by">
                     <option>Top</option>
                     <option>Newest</option>
                     <option>Oldest</option> -->
                    </select>
                  </div>
               </div>
            </div>
   
            <div class="body_comment">
               <div class="row">
                  <div class="avatar_comment col-md-1">
                    <img src="https://static.xx.fbcdn.net/rsrc.php/v1/yi/r/odA9sNLrE86.jpg" alt="avatar"/>
                  </div>
                  <div class="box_comment col-md-11">
                    <textarea class="commentar" placeholder="Add a comment..."></textarea>
                    <div class="box_post">
                     <!-- <div class="pull-left">
                       <input type="checkbox" id="post_fb"/>
                       <label for="post_fb">Also post on Facebook</label>
                     </div> -->
                     <div class="pull-right">
                       <span>
                        <img src="https://static.xx.fbcdn.net/rsrc.php/v1/yi/r/odA9sNLrE86.jpg" alt="avatar" />
                        <i class="fa fa-caret-down"></i>
                       </span>
                       <button onclick="submit_comment()" type="button" value="1">Post</button>
                     </div>
                    </div>
                  </div>
               </div>
               <div class="row">
                  <ul id="list_comment" class="col-md-12">
                     <!-- Start List Comment 1 -->
                     
                     
                     <!-- Start List Comment 2 -->
                     
                  </ul>
               <!-- <button class="show_more" type="button">Load 10 more comments</button> -->
               </div>
            </div>
         </div>
      </div>
   </body>

   
</div>
</ul>


  

</body>
<script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
<script src="http://vjs.zencdn.net/4.3/video.js"></script>
<script src='../dist/videojs-markers.js'></script>

<script>
   // initialize video.js
   var player = videojs('test_video');


   var emote=[];
   var comment=[];
   var timearray=[];


   document.getElementById("test_video").addEventListener("loadedmetadata", function() {
      // this.currentTime = 10;
      console.log("okk")
   });
   // document.getElementsByClassName("vjs-marker")[0].style.color = "blue";


   function onloadfun() {
            var time=1552;
         var time_count=time/20;
         two_sec=2
         console.log(time_count)

         for (let i = 0; i < time_count; i++) {
            markers.push({time: two_sec,
                        text: "Chapter"+two_sec})
            two_sec=two_sec+20
         }
      }

   //load the marker plugin

   var markers = [
         // {
         //    time: 9.5,
         //    text: "Hello"
         // }
      ];

   //load the marker plugin
   player.markers({
      markerTip:{
         display: true,
         text: function(marker){
            return marker.text;
         }
      },
      breakOverlay:{
         display: true,
         displayTime: 2,
         text: function(marker) {
            return "Break overlay: " +"\n\n\n"+ marker.text;
         }
      },
      onMarkerReached: function(marker) {
        console.log(marker);
      },
      markers: markers
   });

   var smile=0;
            var smile1=0;
            var smile2=0;
            var smile3=0;
            var j=0;
            var cnt=0;
            var open=0;
            var c=0;




            var myButton = player.controlBar.addChild("button");
            var myButtonDom = myButton.el();
            myButtonDom.innerHTML = '<button> &#128533</button>';
;
            myButtonDom.style.cssText = 'font-size: 18px;';


                        // $(document).ready(function(){

            myButtonDom.onclick = function(){
            
               document.getElementById("smile").innerHTML = smile;
               var currtime=player.currentTime();
            // console.log(markers[0].time)
               
                                 smile++;
                     
                  l=document.getElementById("list").innerText
                  // console.log(l)
                  // player.markers.add([{
                  //       time: 95,
                  //       text: "😀 : " + smile + "😀 : " + smile
                  //    }]);
                    

                  console.log(emote.length)
                  // emote.push({time:player.currentTime(),text :"😆"+player.currentTime()})
                  // cnt++;
                  console.log(emote)
                  var currenttime1=player.currentTime();
                     
                     // var item1 = $("<li data-index='"+j+"'><a href='#'>"+emote[j].text+"</a></li>");
                     // j++;
                     // $("#marker-list").append(item1);


         
                  
                  // if(currtime>markers[0].time && currtime <markers[1].time )
                  // {
                  //       // console.log("ok")
                  //                smile1++;
                  //                player.markers.add([{
                  //                      time: markers[1].time,
                  //                      text: "😀 : "+ smile1 + "😀 : " + smile1,
                                       
                  //                   }]);
                  //                   // emote.push({time:player.currentTime(),text :"😆"+player.currentTime()})
                  //                   // cnt++;
         
                  // }
                  markers.push({time:player.currentTime(),text :"😀"+player.currentTime()})
                  emote.push({time:player.currentTime(),text :"😀"+format(Math.trunc(player.currentTime()))})

                                    cnt++;
                  console.log('Marker',markers)
                  start(cnt);

                
            } 
          

            var myButton1 = player.controlBar.addChild("button");
            var myButtonDom1 = myButton1.el();
            myButtonDom1.innerHTML = '<button> &#128533</button>';
            myButtonDom1.style.cssText = 'font-size: 18px;';

            myButtonDom1.onclick = function(){
            
               var t=player.currentTime();
               t=Math.trunc(t)
               console.log(t)


               if(t%2!=0)
               {
                  timearray.push({time:t+1,text :smile1})
                  index=timearray.findIndex((obj=>obj.time==t+1))
                  let counter=0
                  for(let i=0;i<timearray.length;i++)
                  {
                     if(timearray[i].time==t+1)counter++;
                  }
                  console.log('counter',counter)

                  console.log("index",index)
                  console.log("count",timearray)


                  player.markers.add([{
                        time: t+1,
                        text: "😕 : " + counter +  " " + "👍 : " + 1 +" "+"🤔 :" + 2
                     }]);

               }


               else{

                  timearray.push({time:t+2,text :smile1})
                  index=timearray.findIndex((obj=>obj.time==t+2))
                  let counter=0
                  for(let i=0;i<timearray.length;i++)
                  {
                     if(timearray[i].time==t+2)counter++;
                  }
                  console.log('counter',counter)

                  console.log("index",index)
                  console.log("count",timearray)

                  player.markers.add([{
                        time: t+2,
                        text: "😕 : " + counter + " " + "👍 : " + 1 +" " +"🤔 :" + 2
                     }]);
               }
               
              


                
            } 


            var myButton3 = player.controlBar.addChild("button");
            var myButtonDom3 = myButton3.el();
            myButtonDom3.innerHTML = '<button>&#128077</button>';
            myButtonDom3.style.cssText = 'font-size: 18px;';
            myButtonDom3.onclick = function(){



               console.log("hello")
            
               openForm();

             
            } 


            var myButton4 = player.controlBar.addChild("button");
            var myButtonDom4 = myButton4.el();
            myButtonDom4.innerHTML = '<button>&#129300</button>';
            myButtonDom4.style.cssText = 'font-size: 18px;';
            myButtonDom4.onclick = function(){



               console.log("hello")
            
               openForm();

             
            }







            var myButton2 = player.controlBar.addChild("button");
            var myButtonDom2 = myButton2.el();
            myButtonDom2.innerHTML = '<button>Comment &#9993</button>';
            myButtonDom2.style.cssText = 'font-size: 25px;';
            myButtonDom2.onclick = function(){



               console.log("hello")
            
               openForm();

             
            } 




            function start(s)
            {
               $(document).ready(function(){
               // insert marker list
               // for(var i =s-1; i < emote.length; i++){
                  var item = $("<li data-index='"+s+"'><a href='#'>"+emote[s-1].text+"</a></li>");
                  $("#marker-list").append(item);
               // }

               // set up click event
               $("#marker-list li").click(function(){
                  var index = $(this).data("index");
                  console.log(index)

                  player.currentTime(emote[index-1].time);
               });

            });
      }

      $(document).ready(function(){
    
  $(".moveToVideoJs").appendTo($('#test_video'));
		// show advertisement label while play advertisement
		
		// Stop from seeking while playing advertisement
		
		
		// Hide Advertisement label and change data-src of player to play actual video
		
});

function openForm() {

   if (open==0){
      document.getElementById("myForm").style.display = "block";
      open=1

   }
   else
   {
      document.getElementById("myForm").style.display = "none";
      open=0

   }


}

function closeForm() {

   open=0
  document.getElementById("myForm").style.display = "none";

}

function submit()
{
   open=0
   var cmt=document.getElementById("user_input").value;
   console.log(cmt)
   document.getElementById('display').innerHTML = document.getElementById("user_input").value;

   comment.push({time:player.currentTime(),text :cmt+" "+"@"+" "+ format(Math.trunc(player.currentTime()))})
   console.log(comment[0].text)

   $(document).ready(function(){
         // insert marker list
               // for(var i =s-1; i < emote.length; i++){
                  console.log("okok")
                  var item1 = $("<li data-commentindex='"+c+"'><a href='#'>"+comment[c].text+"</a></li>");
                  $("#marker-list1").append(item1);
               // }

               // set up click event
               $("#marker-list1 li").click(function(){
                  var index1 = $(this).data("commentindex");
                  console.log(index1)

                  player.currentTime(comment[index1].time);
               });
               c++;

            });



   document.getElementById("myForm").style.display = "none";

    
}

      

   $(document).ready(function(){
      // insert marker list
      for(var i =0; i < markers.length; i++){
         var item = $("<li data-index='"+i+"'><a href='#'>"+markers[i].text+"</a></li>");
         $("#marker-list").append(item);
      }

      // set up click event
      $("#marker-list li").click(function(){
         var index = $(this).data("index");

         player.currentTime(markers[index].time);
      });

   });
   function format(time) {   
    // Hours, minutes and seconds
    var hrs = ~~(time / 3600);
    var mins = ~~((time % 3600) / 60);
    var secs = ~~time % 60;

    // Output like "1:01" or "4:03:59" or "123:03:59"
    var ret = "";
    if (hrs > 0) {
        ret += "" + hrs + ":" + (mins < 10 ? "0" : "");
    }
    ret += "" + mins + ":" + (secs < 10 ? "0" : "");
    ret += "" + secs;
    return ret;
}

//Facebook Comments Js

         function submit_comment(){
         var comment = $('.commentar').val();
         el = document.createElement('li');
         el.className = "box_result row";
         el.innerHTML =
               '<div class=\"avatar_comment col-md-1\">'+
               '<img src=\"https://static.xx.fbcdn.net/rsrc.php/v1/yi/r/odA9sNLrE86.jpg\" alt=\"avatar\"/>'+
               '</div>'+
               '<div class=\"result_comment col-md-11\">'+
               '<h4>Joncena</h4>'+
               '<p>'+ comment +'</p>'+
               '<div class=\"tools_comment\">'+
               '<a class=\"like\" >Like</a><span aria-hidden=\"true\"> · </span>'+
               '<i class=\"fa fa-thumbs-o-up\"></i> <span class=\"count\">0</span>'+
               '<span aria-hidden=\"true\"> · </span>'+
               '<a class=\"replay\" >Reply</a><span aria-hidden=\"true\"> · </span>'+
                  '<span>1m</span>'+
               '</div>'+
               '<ul class="child_replay"></ul>'+
               '</div>';
            document.getElementById('list_comment').prepend(el);
            $('.commentar').val('');
         }

         $(document).ready(function() {
            $('#list_comment').on('click', '.like', function (e) {
               $current = $(this);
               var x = $current.closest('div').find('.like').text().trim();
               var y = parseInt($current.closest('div').find('.count').text().trim());
               
               if (x === "Like") {
                  $current.closest('div').find('.like').text('Unlike');
                  $current.closest('div').find('.count').text(y + 1);
               } else if (x === "Unlike"){
                  $current.closest('div').find('.like').text('Like');
                  $current.closest('div').find('.count').text(y - 1);
               } else {
                  var replay = $current.closest('div').find('.like').text('Like');
                  $current.closest('div').find('.count').text(y - 1);
               }
            });
            
            $('#list_comment').on('click', '.replay', function (e) {
               cancel_reply();
               $current = $(this);
               el = document.createElement('li');
               el.className = "box_reply row";
               el.innerHTML =
                  '<div class=\"col-md-12 reply_comment\">'+
                     '<div class=\"row\">'+
                        '<div class=\"avatar_comment col-md-1\">'+
                        '<img src=\"https://static.xx.fbcdn.net/rsrc.php/v1/yi/r/odA9sNLrE86.jpg\" alt=\"avatar\"/>'+
                        '</div>'+
                        '<div class=\"box_comment col-md-10\">'+
                        '<textarea class=\"comment_replay\" placeholder=\"Add a comment...\"></textarea>'+
                        '<div class=\"box_post\">'+
                           '<div class=\"pull-right\">'+
                           '<span>'+
                              '<img src=\"https://static.xx.fbcdn.net/rsrc.php/v1/yi/r/odA9sNLrE86.jpg\" alt=\"avatar\" />'+
                              '<i class=\"fa fa-caret-down\"></i>'+
                           '</span>'+
                           '<button class=\"cancel\" onclick=\"cancel_reply()\" type=\"button\">Cancel</button>'+
                           '<button onclick=\"submit_reply()\" type=\"button\" value=\"1\">Reply</button>'+
                           '</div>'+
                        '</div>'+
                        '</div>'+
                     '</div>'+
                  '</div>';
               $current.closest('li').find('.child_replay').prepend(el);
            });
         });

         function submit_reply(){
         var comment_replay = $('.comment_replay').val();
         el = document.createElement('li');
         el.className = "box_reply row";
         el.innerHTML =
               '<div class=\"avatar_comment col-md-1\">'+
               '<img src=\"https://static.xx.fbcdn.net/rsrc.php/v1/yi/r/odA9sNLrE86.jpg\" alt=\"avatar\"/>'+
               '</div>'+
               '<div class=\"result_comment col-md-11\">'+
               '<h4>Johncena</h4>'+
               '<p>'+ comment_replay +'</p>'+
               '<div class=\"tools_comment\">'+
               '<a class=\"like\" >Like</a><span aria-hidden=\"true\"> · </span>'+
               '<i class=\"fa fa-thumbs-o-up\"></i> <span class=\"count\">0</span>'+
               '<span aria-hidden=\"true\"> · </span>'+
               '<a class=\"replay\" >Reply</a><span aria-hidden=\"true\"> · </span>'+
                  '<span>1m</span>'+
               '</div>'+
               '<ul class="child_replay"></ul>'+
               '</div>';
            $current.closest('li').find('.child_replay').prepend(el);
            $('.comment_replay').val('');
            cancel_reply();
         }

         function cancel_reply(){
            $('.reply_comment').remove();
         }

</script>
</html>
